!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.fe=t.fe||{},t.fe.im=e())}(this,function(){"use strict";function t(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}function e(t,e){return t===e||t!==t&&e!==e}function n(t,e){return e={exports:{}},t(e,e.exports),e.exports}function r(t){var e=rt.call(t,ot),n=t[ot];try{t[ot]=void 0;var r=!0}catch(t){}var i=it.call(t);return r&&(e?t[ot]=n:delete t[ot]),i}function i(t){return at.call(t)}function o(t){return null==t?void 0===t?st:lt:dt&&dt in Object(t)?ut(t):ft(t)}function u(t){var e=void 0===t?"undefined":Z(t);return null!=t&&("object"==e||"function"==e)}function c(t){if(!bt(t))return!1;var e=pt(t);return e==yt||e==ht||e==mt||e==vt}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=jt}function f(t){return null!=t&&wt(t.length)&&!gt(t)}function l(t,e){return!!(e=null==e?_t:e)&&("number"==typeof t||At.test(t))&&t>-1&&t%1==0&&t<e}function s(t,e,n){if(!bt(n))return!1;var r=void 0===e?"undefined":Z(e);return!!("number"==r?Ot(n)&&Tt(e,n.length):"string"==r&&e in n)&&W(n[e],t)}function d(t){return null!=t&&"object"==(void 0===t?"undefined":Z(t))}function p(t){return"symbol"==(void 0===t?"undefined":Z(t))||xt(t)&&pt(t)==Ct}function b(t){if("number"==typeof t)return t;if(kt(t))return It;if(bt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=bt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Nt,"");var n=Et.test(t);return n||Pt.test(t)?Mt(t.slice(2),n?2:8):Bt.test(t)?It:+t}function m(t){if(!t)return 0===t?t:0;if((t=$t(t))===Lt||t===-Lt){return(t<0?-1:1)*Ft}return t===t?t:0}function y(t){var e=Ut(t),n=e%1;return e===e?n?e-n:e:0}function h(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&St(t,e,n)?(e=0,n=r):(e=null==e?0:Ht(e),n=void 0===n?r:Ht(n)),D(t,e,n)):[]}function v(t){return!!Wt&&Wt in t}function g(t){if(null!=t){try{return Gt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function j(t){return!(!bt(t)||qt(t))&&(gt(t)?ee:Jt).test(Qt(t))}function w(t,e){return null==t?void 0:t[e]}function O(t,e){var n=re(t,e);return ne(n)?n:void 0}function _(t,e,n){"__proto__"==e&&ue?ue(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function A(t,e,n){var r=t[e];fe.call(t,e)&&W(r,n)&&(void 0!==n||e in t)||ce(t,e,n)}function T(t,e,n,r){var i=!n;n||(n={});for(var o=-1,u=e.length;++o<u;){var c=e[o],a=r?r(n[c],t[c],c,n,t):void 0;void 0===a&&(a=t[c]),i?ce(n,c,a):le(n,c,a)}return n}function S(t){return t}function x(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function C(t,e,n){return e=be(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=be(r.length-e,0),u=Array(o);++i<o;)u[i]=r[e+i];i=-1;for(var c=Array(e+1);++i<e;)c[i]=r[i];return c[e]=n(u),pe(t,this,c)}}function k(t){return function(){return t}}function I(t){var e=0,n=0;return function(){var r=we(),i=je-(r-n);if(n=r,i>0){if(++e>=ge)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function N(t,e){return Ae(me(t,e,de),t+"")}function B(t){return Te(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,u&&St(n[0],n[1],u)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var c=n[r];c&&t(e,c,r,o)}return e})}function E(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||xe)}function P(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function M(t){return xt(t)&&pt(t)==Ie}function $(){return!1}function L(t){return xt(t)&&wt(t.length)&&!!Re[pt(t)]}function F(t){return function(e){return t(e)}}function U(t,e){var n=Fe(t),r=!n&&$e(t),i=!n&&!r&&He(t),o=!n&&!r&&!i&&Ge(t),u=n||r||i||o,c=u?ke(t.length,String):[],a=c.length;for(var f in t)!e&&!Ve.call(t,f)||u&&("length"==f||i&&("offset"==f||"parent"==f)||o&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Tt(f,a))||c.push(f);return c}function H(t,e){return function(n){return t(e(n))}}function R(t){if(!Ce(t))return Ye(t);var e=[];for(var n in Object(t))en.call(t,n)&&"constructor"!=n&&e.push(n);return e}function z(t){return Ot(t)?Je(t):nn(t)}var D=t,W=e,q="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Q=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),V="object"==Z(q)&&q&&q.Object===Object&&q,J=V,K="object"==("undefined"==typeof self?"undefined":Z(self))&&self&&self.Object===Object&&self,X=J||K||Function("return this")(),Y=X,tt=Y.Symbol,et=tt,nt=Object.prototype,rt=nt.hasOwnProperty,it=nt.toString,ot=et?et.toStringTag:void 0,ut=r,ct=Object.prototype,at=ct.toString,ft=i,lt="[object Null]",st="[object Undefined]",dt=et?et.toStringTag:void 0,pt=o,bt=u,mt="[object AsyncFunction]",yt="[object Function]",ht="[object GeneratorFunction]",vt="[object Proxy]",gt=c,jt=9007199254740991,wt=a,Ot=f,_t=9007199254740991,At=/^(?:0|[1-9]\d*)$/,Tt=l,St=s,xt=d,Ct="[object Symbol]",kt=p,It=NaN,Nt=/^\s+|\s+$/g,Bt=/^[-+]0x[0-9a-f]+$/i,Et=/^0b[01]+$/i,Pt=/^0o[0-7]+$/i,Mt=parseInt,$t=b,Lt=1/0,Ft=1.7976931348623157e308,Ut=m,Ht=y,Rt=h,zt=Y["__core-js_shared__"],Dt=zt,Wt=function(){var t=/[^.]+$/.exec(Dt&&Dt.keys&&Dt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),qt=v,Zt=Function.prototype,Gt=Zt.toString,Qt=g,Vt=/[\\^$.*+?()[\]{}|]/g,Jt=/^\[object .+?Constructor\]$/,Kt=Function.prototype,Xt=Object.prototype,Yt=Kt.toString,te=Xt.hasOwnProperty,ee=RegExp("^"+Yt.call(te).replace(Vt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=j,re=w,ie=O,oe=function(){try{var t=ie(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),ue=oe,ce=_,ae=Object.prototype,fe=ae.hasOwnProperty,le=A,se=T,de=S,pe=x,be=Math.max,me=C,ye=k,he=ue?function(t,e){return ue(t,"toString",{configurable:!0,enumerable:!1,value:ye(e),writable:!0})}:de,ve=he,ge=800,je=16,we=Date.now,Oe=I,_e=Oe(ve),Ae=_e,Te=N,Se=B,xe=Object.prototype,Ce=E,ke=P,Ie="[object Arguments]",Ne=M,Be=Object.prototype,Ee=Be.hasOwnProperty,Pe=Be.propertyIsEnumerable,Me=Ne(function(){return arguments}())?Ne:function(t){return xt(t)&&Ee.call(t,"callee")&&!Pe.call(t,"callee")},$e=Me,Le=Array.isArray,Fe=Le,Ue=$,He=n(function(t,e){var n=e&&!e.nodeType&&e,r=n&&!0&&t&&!t.nodeType&&t,i=r&&r.exports===n,o=i?Y.Buffer:void 0,u=o?o.isBuffer:void 0,c=u||Ue;t.exports=c}),Re={};Re["[object Float32Array]"]=Re["[object Float64Array]"]=Re["[object Int8Array]"]=Re["[object Int16Array]"]=Re["[object Int32Array]"]=Re["[object Uint8Array]"]=Re["[object Uint8ClampedArray]"]=Re["[object Uint16Array]"]=Re["[object Uint32Array]"]=!0,Re["[object Arguments]"]=Re["[object Array]"]=Re["[object ArrayBuffer]"]=Re["[object Boolean]"]=Re["[object DataView]"]=Re["[object Date]"]=Re["[object Error]"]=Re["[object Function]"]=Re["[object Map]"]=Re["[object Number]"]=Re["[object Object]"]=Re["[object RegExp]"]=Re["[object Set]"]=Re["[object String]"]=Re["[object WeakMap]"]=!1;var ze=L,De=F,We=n(function(t,e){var n=e&&!e.nodeType&&e,r=n&&!0&&t&&!t.nodeType&&t,i=r&&r.exports===n,o=i&&J.process,u=function(){try{return o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=u}),qe=We&&We.isTypedArray,Ze=qe?De(qe):ze,Ge=Ze,Qe=Object.prototype,Ve=Qe.hasOwnProperty,Je=U,Ke=H,Xe=Ke(Object.keys,Object),Ye=Xe,tn=Object.prototype,en=tn.hasOwnProperty,nn=R,rn=z,on=Object.prototype,un=on.hasOwnProperty,cn=(Se(function(t,e){if(Ce(e)||Ot(e))return void se(e,rn(e),t);for(var n in e)un.call(e,n)&&le(t,n,e[n])}),function(){function t(e){G(this,t),e=e||{},this.effect=e.effect||"flash",this._title=document.title,this.title=document.title,this.interval=300}Q(t,[{key:"__addTimer",value:function(){return this._clearTimer(),this.timer=setInterval(this.__setTitle.bind(this),this.interval),this}},{key:"_clearTimer",value:function(){return clearInterval(this.timer),document.title=this.title,this}},{key:"__setTitle",value:function(){"flash"==this.effect?document.title=this.title===document.title?this._title:this.title:(document.title=document.title.slice(1),0===document.title.length&&(document.title=this._title))}},{key:"setTitle",value:function(t){return!0===t?this._addTimer():t?(this._title=t,this.__addTimer()):(this._clearTimer(),this.title=this.title),this}}])}(),function(){function t(e){G(this,t);var n=document.createElement("audio");this.audio=n,n.id="im-audio",n.preload="preload",n.innerHTML='<source src="//static.wuage.com/message/im/src/music/ding.mp3" type="audio/mp3" />\n                    <source src="//static.wuage.com/message/im/src/music/ding.ogg" type="audio/ogg" />\n                    <embed height="100" width="100" src="//static.wuage.com/message/im/src/music/ding.mp3" />',document.getElementsByTagName("body")[0].appendChild(n)}return Q(t,[{key:"play",value:function(){this.audio.play()}}]),t}()),an=window.jQuery,fn={hidden:!1,sdk:null,isIMLogin:null,subscribe:null,msgCount:null,voice:null,im:null},ln={init:function(){ln.initCache(),ln.getIMAccount(),ln.initEvent(),"1"===an(".im-script").attr("data-type")&&fn.im.showBar()},initCache:function(){fn.subscribe={msg:[]},fn.msgCount=0,fn.voice=new cn,ln.initCacheIM()},initEvent:function(){an(window).focus(function(){fn.hidden=!1}),an(window).blur(function(){fn.hidden=!0}),an(document).on("click",function(){fn.hidden=!1})},getIMAccount:function(){fn.im;setInterval(function(){if(fn.hidden)return 1;var t=0;an.ajax({url:"//chat.wuage.com/web/message/unreadNum.jsonp",dataType:"jsonp",timeout:1e4}).done(function(e){e&&1===e.status&&e.data&&"number"==typeof e.data.unreadNumCount&&(fn.msgCount=e.data.unreadNumCount,0===t?fn.im.trigger("ready",e.data.unreadNumCount):fn.im.trigger("msg",e.data.unreadNumCount),t++)})},2e3)},initCacheIM:function(){var t=function t(e,n){var r=window.encodeURIComponent,i="//chat.wuage.com/index.html";if(e){var o=r(e),u=new RegExp("^(https?|ftp|file)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]$"),c=/^https?:\/\/item\.wuage\.com\/\d+\.html/,a="";n&&u.test(n)&&c.test(n)?a=n?r(n):"":n&&(a=n?r("我正在关注【"+n+"】"):""),i+="?uid="+o+(n?"&msg="+a:"")}if(t.win&&t.win.close(),t.win&&!t.win.closed)t.win.location.href="function"==typeof window.doPSAURL?window.doPSAURL(i,{psa:"j6 "}):i,t.win.focus();else{var f=window.innerWidth>900?(window.innerWidth-900)/2:0,l=window.innerHeight>560?(window.innerHeight-560)/2:0;t.win=window.open(i,"","width=900,height=560,top="+l+",left="+f+",toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no, status=no",{psa:"j2",current:!1})}};fn.im=t,t.on=function(e,n){var r=fn.subscribe[e]||[];return r.push(n),fn.subscribe[e]=r,t},t.off=function(e,n){!n||(fn.subscribe[e]=[]);var r=fn.subscribe[e];if(r&&r.length){var i=0;for(r.length;i<lengh;i++)if(n=r[i]){r.splice(i,1);break}fn.subscribe[e]=r}return t},t.trigger=function(){if(!arguments.length)return t;var e=arguments[0],n=Rt(arguments,1);if(fn.subscribe[e]&&fn.subscribe[e].length)for(var r=0,i=fn.subscribe[e].length;r<i;r++){var o=fn.subscribe[e][r];o.apply(t,n)}},t.showBar=function(){var e=document,n=e.querySelector("head"),r=e.createElement("link");r.rel="stylesheet",r.type="text/css",r.href="//static.wuage.com/gangding/gangding-jdk/dist/v1/im-bar.css",n.appendChild(r);var i=e.createElement("div");i.className="fe-imBar",i.addEventListener("click",function(){t()}),e.querySelector("body").appendChild(i),t.on("ready",function(t){if(0===t)return i.className="fe-imBar",i.innerHTML="",1;i.className="fe-imBar active",i.innerHTML='<span class="fe-imBar-number">'+(t>99?"99+":t)+"</span>"}),t.on("msg",function(t,e){if(0===e)return i.className="fe-imBar",i.innerHTML="",1;i.className="fe-imBar active",i.innerHTML='<span class="fe-imBar-number">'+(e>99?"99+":e)+"</span>"})}}};return ln.init(),fn.im});